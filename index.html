<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Raid Door Checklist</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="page-layout">
  <div class="card">
    <h2>Raid Door Checklist</h2>
    
    <div id="input-row" class="input-row">
      <input type="text" id="username" placeholder="Your name" maxlength="20">
      <input type="text" id="joinCode" placeholder="Room code">
      <div class="action-buttons">
        <button id="createBtn">Create Raid</button>
        <button id="joinBtn">Join Room</button>
      </div>
    </div>

    <div id="color-selector" class="color-selector-row hidden">
      <label for="userColor">Choose your colour:</label>
      <select id="userColor" style="height:30px;">
        <option value="green">Green</option>
        <option value="blue">Blue</option>
        <option value="yellow">Yellow</option>
        <option value="purple">Purple</option>
      </select>
      <button id="advancedColorBtn">Advanced</button>
      <input type="text" id="advancedColorInput" placeholder="#HEX" style="display:none; width:80px; margin-left:5px;">
    </div>

    <div id="room-info" class="hidden" style="margin-top:10px;">
      <div style="position: relative; display: inline-block;">
        Room: <span id="room-code" style="font-weight: bold; letter-spacing: 1px;"></span>
        <button id="copy-room-btn" class="copy-btn" title="Copy Code">
          <svg viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></svg>
        </button>
      </div><br>
      Map: <span id="current-map-name" style="font-weight:bold; color:#aaa;">-</span><br>
      Time left: <span id="room-timer">--:--</span><br>
      <button id="reset-btn" style="margin-top:5px;"onclick="resetdoors()" >Reset Doors</button>
      <button id="delete-btn" style="margin-top:5px; margin-left:5px;" onclick="openModal('delete-room-modal')">Delete Room</button>
      <button id="leave-btn" style="margin-top:5px; margin-left:5px;" onclick="openModal('leave-room-modal')">Leave Room</button>
    </div>

    <div id="users-list" class="hidden" style="margin-top:10px;"></div>
    <div id="floor-buttons" class="hidden" style="margin-top:10px;"></div>

    <div class="map-container hidden">
      <img id="map-image" class="map-image" src="" alt="Floor Map">
    </div>
  </div>

  <div id="armory-status-card" class="side-card hidden">
    <h3>Armory Status</h3>
    <p style="font-size: 11px; color: #aaa; margin-bottom: 10px;">Track entry timers:</p>
    
    <ul id="armory-status-list">
        <li class="armory-item" data-id="timer_140_1">
            <div class="door-title">1m 40s Door (1)</div>
            <div class="armory-timer-text">Ready</div>
        </li>
        <li class="armory-item" data-id="timer_140_2">
            <div class="door-title">1m 40s Door (2)</div>
            <div class="armory-timer-text">Ready</div>
        </li>
        <li class="armory-item" data-id="timer_60">
            <div class="door-title">1m Door</div>
            <div class="armory-timer-text">Ready</div>
        </li>
    </ul>

    <div style="display: flex; justify-content: center; width: 100%; margin-top: 10px;">
        <button id="reset-levers-btn">Reset Levers</button>
    </div>
</div>

  <div id="door-card" class="side-card hidden">
    <div class="progress-wrap">
      <div id="door-progress-text">0 / 0 opened</div>
      <div id="door-progress">
        <div id="door-progress-bar"></div>
      </div>
    </div>
    <h3>Door Checklist</h3>
    <ul id="door-list"></ul>
  </div>

  <div id="history-card" class="side-card hidden">
    <h3>History</h3>
    <ul id="history-list"></ul>
  </div>

  <div id="notifications-container"></div>

  <div id="map-modal" class="modal-overlay hidden">
  <div class="modal-content">
    <h3>Select Map</h3>
    <select id="map-select-dropdown"></select>
    <div style="display: flex; gap: 10px; justify-content: flex-end;">
      <button id="cancel-map-btn" style="background: #444;">Cancel</button>
      <button id="confirm-map-btn">Create Raid</button>
    </div>
  </div>
</div>
</div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="script.js"></script>


<div id="join-modal" class="modal hidden">
  <div class="modal-backdrop" onclick="closeModal('join-modal')"></div>

  <div class="modal-card">
    <div class="modal-header">
      <span>Join Raid Room</span>
      <button class="modal-close" onclick="closeModal('join-modal')">✕</button>
    </div>

    <div class="modal-body">
      <label for="modalJoinCode">Room Code</label>
      <input
        type="text"
        id="modalJoinCode"
        placeholder="Enter room code"
        maxlength="12"
      >
    </div>

    <div class="modal-footer">
      <button onclick="confirmJoinRoom()">Join</button>
      <button onclick="closeModal('join-modal')">Cancel</button>
    </div>
  </div>
</div>


<div id="delete-room-modal" class="modal hidden">
  <div class="modal-backdrop" onclick="closeModal('delete-room-modal')"></div>

  <div class="modal-card">
    <div class="modal-header warning">
      <span>Delete Room</span>
      <button class="modal-close" onclick="closeModal('delete-room-modal')">✕</button>
    </div>

    <div class="modal-body">
      <p>
        This will <b>permanently delete</b> the room for all users.
        <br><br>
        <span style="color:#ff9f43">
          This action cannot be undone.
        </span>
      </p>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" onclick="closeModal('delete-room-modal')">Cancel</button>
      <button class="btn-danger" onclick="deleteRoom()">
        Delete Room
      </button>
    </div>
  </div>
</div>

<div id="reset-doors-modal" class="modal hidden">
  <div class="modal-backdrop" onclick="closeModal('reset-doors-modal')"></div>

  <div class="modal-card">
    <div class="modal-header warning">
      <span>Reset Doors</span>
      <button class="modal-close" onclick="closeModal('reset-doors-modal')">✕</button>
    </div>

    <div class="modal-body">
      <p>
        This will mark <b>all doors as closed</b> for everyone in the room.
        <br><br>
        Are you sure you want to continue?
      </p>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" onclick="closeModal('reset-doors-modal')">Cancel</button>
      <button class="btn-warning" onclick="resetdoors()">
        Reset Doors
      </button>
    </div>
  </div>
</div>

<div id="leave-room-modal" class="modal hidden">
  <div class="modal-backdrop" onclick="closeModal('leave-room-modal')"></div>

  <div class="modal-card">
    <div class="modal-header warning">
      <span>Leave Room</span>
      <button class="modal-close" onclick="closeModal('leave-room-modal')">✕</button>
    </div>

    <div class="modal-body">
      <p>
        Are you sure you want to leave this room?<br>
        <b>You will stop seeing door updates.</b>
      </p>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" onclick="closeModal('leave-room-modal')">Cancel</button>
      <button
        class="btn-danger"
        onclick="leaveRoom()"
      >
        Leave Room
      </button>
    </div>
  </div>
</div>


</body>
</html>
